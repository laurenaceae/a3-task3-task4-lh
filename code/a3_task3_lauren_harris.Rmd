---
title: "Assignment 3 - Task 3 - Lauren Harris"
author: "Lauren Harris"
date: "10/21/2021"
output: html_document
---
### Setup
```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(here)
library(tidyverse)
library(janitor)
library(kableExtra)
library(lubridate)
```

### Read in data
```{r}
urchins_data <- read_csv(here("data", "urchins.csv"))
```

### Clean up data
```{r}
urchins_clean <- urchins_data %>% 
  clean_names()
```

### Urchin Data visualization
```{r}
# Comparing the sizes of red and purple urchins with a histogram
ggplot(data = urchins_clean, aes(x = size, color = common_name)) +
  geom_histogram(bin_width = 10) +
  facet_wrap(~common_name) +
  labs(x = "Urchin diameter (cm)", y = "Count") +
  theme(legend.position = "none") +
  scale_color_manual(values = c("purple", "red"))
```


Counts of purple urchins (Strongylocentrotus purpuratus) and red urchins (Mesocentrotus franciscanus) at different body diameters (cm). Data was taken along the Santa Barbara coast from 2008 to 2020. 

### Urchin Data Table
```{r}
urchins_size_subset <- urchins_clean %>% 
  group_by(common_name, scientific_name) %>% 
  summarize(mean_size = mean(size), median_size = median(size), sd_size = sd(size), n_size = n()) 

urchins_size_subset %>% 
  kable(digits = 2, col.names = c("Common Name", "Scientific Name","Mean Size (cm)", "Median Size (cm)", "Standard Deviation", "Sample Size")) %>% 
  kable_styling(full_width = FALSE)
```
The mean and median sizes of the red urchin is larger than the mean and median sizes of purple urchins. The spread of the data is also wider for red urchins, meaning they are more variable. This is also reflected through a higher standard deviation. The red urchins also had a larger range of values, as both urchins had values at zero but the max value for red urchins was past 12 and it was under 10 for purple urchins. 

### Purple Urchin Analysis
```{r}
purple_urchins <- urchins_clean %>% 
  filter(common_name == "Purple Urchin") %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date)) %>% 
  mutate(site_full = case_when(site %in% "NAPL" ~"Naples Reef",
         site %in% "AQUE" ~"Arroyo Quemado Reef",
         site %in% "CARP" ~"Carpinteria Reef", 
         site %in% "MOHK" ~"Mohawk Reef",
         site %in% "IVEE" ~"Isla Vista Reef"))

purple_urchins_totals <- purple_urchins %>% 
  group_by(site_full, year) %>% 
  summarize(n = n())
```

### Purple Urchin Data Visualization
```{r}
ggplot(data = purple_urchins_totals, aes(x = year, y = n)) +
  geom_col(color = "purple") +
  facet_wrap(~site_full) +
  labs(x = "Year", y = "Number of Purple Urchins")
```

Purple urchin observations by location and year. Five plots representing different location along the Santa Barbara, California coast, each containing counts of the number of purple urchins (Strongylocentrotus purpuratus) observed by year. Dates span from 2008 to 2020. 

For these data to be useful it must include the amount of time spent making observations. If a given year was low effort and little time was spent making observations, it would appear that there were less urchins even if that does not reflect the true population. An alternative explanation for a low urchin year other than urchins actually being sparse could be that funding was cut and fewer people could be paid to go make urchin observations. 